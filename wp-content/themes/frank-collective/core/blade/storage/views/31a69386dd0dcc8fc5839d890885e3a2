<?php /* Template Name: Home */ ?>
<?php \Laravel\Section::start('body-class', 'page-homepage'); ?>
<?php \Laravel\Section::start('content'); ?>
<?php while ( have_posts() ) : the_post(); ?>
<div class="root barba-container" data-namespace="homepage" data-page-id="Homepage" data-transition-in="homepage_in" data-transition-out="homepage_out" data-page-init="homepage_init">
    <div class="nav-hero" id="homepage-background">
        <div class="nav-hero-content" >
            <div class="container">
                <div class="bg-stretch">
                    <span data-srcset="<?php echo  helper::imageURL(get_field('background_image'), 'full') ; ?>"></span>
                    <?php if(get_field('background_video')): ?>
                        <div class="video-wrap">
                            <video id="home-page-video" autoplay playsinline muted loop class="video <?php echo  get_field('video_start_time') ? 'video-has-offset' : false ; ?>">
                                <source src="<?php echo  get_field('background_video') ; ?>" type="video/mp4">
                            </video>
                        </div>
                        <?php if(get_field('video_start_time')): ?>
                            <script>
                                window.home_video_offests = <?php echo  json_encode((array)get_field('video_start_time')) ; ?>;
                                var video = document.getElementsByClassName('video-has-offset');
                                if (video.length){
                                    document.getElementById('home-page-video').addEventListener('loadedmetadata', function() {
                                        if(typeof window.home_video_offests !== 'undefined' && window.home_video_offests.length){
                                            var rand = window.home_video_offests[Math.random() * window.home_video_offests.length >> 0]
                                            console.log('home video start time', rand.time);
                                            if(parseInt(rand.time) > 0){
                                                this.currentTime = parseInt(rand.time);
                                            }
                                        }
                                    }, false);
                                }
                            </script>
                        <?php endif; ?>
                    <?php endif; ?>
                </div>
                <?php if(get_field('menu_items')): ?>
                    <div class="nav-links">
                        <?php foreach((array) get_field('menu_items') as $item): ?>
                            <?php if($item['label']): ?>
                                <div class="nav-link">
                                    <a href="<?php echo  $item['page'] ; ?>"><?php echo  $item['label'] ; ?></a>
                                </div>
                            <?php endif; ?>
                        <?php endforeach; ?>
                    </div>
                <?php endif; ?>
            </div>
        </div>
    </div>
</div>
<?php endwhile; ?>
<?php \Laravel\Section::stop(); ?>
<?php echo view('layouts/master')->with(get_defined_vars())->render(); ?>